<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç Dev —Ä–µ–∂–∏–º–∞</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç Dev —Ä–µ–∂–∏–º–∞</h1>
    
    <div id="results"></div>
    
    <script>
        const results = document.getElementById('results');
        
        // –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ dev —Ä–µ–∂–∏–º–∞
        function testDevMode() {
            const div = document.createElement('div');
            div.className = 'test info';
            
            const isDev = window.location.hostname === 'localhost' || 
                         window.location.hostname === '127.0.0.1' ||
                         window.location.port === '5173';
            
            div.innerHTML = `
                <h3>üîç –¢–µ—Å—Ç Dev —Ä–µ–∂–∏–º–∞</h3>
                <p><strong>Hostname:</strong> ${window.location.hostname}</p>
                <p><strong>Port:</strong> ${window.location.port}</p>
                <p><strong>Dev —Ä–µ–∂–∏–º:</strong> ${isDev ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç'}</p>
            `;
            
            results.appendChild(div);
            return isDev;
        }
        
        // –¢–µ—Å—Ç 2: –¢–µ—Å—Ç fallback —Ñ—É–Ω–∫—Ü–∏–∏
        function testFallbackFunction() {
            const div = document.createElement('div');
            div.className = 'test info';
            
            const getDemoToolsForProfession = (profession) => {
                const professionTools = {
                    frontend: ['JavaScript', 'React', 'TypeScript', 'Vue.js'],
                    backend: ['Node.js', 'Python', 'Java', 'Go'],
                    fullstack: ['JavaScript', 'React', 'Node.js', 'TypeScript'],
                    mobile: ['React Native', 'Flutter', 'Swift', 'Kotlin'],
                    devops: ['Docker', 'Kubernetes', 'AWS', 'Linux'],
                    data: ['Python', 'SQL', 'Pandas', 'TensorFlow'],
                };
                
                return professionTools[profession || 'frontend'] || professionTools.frontend;
            };
            
            const tests = [
                { profession: 'frontend', expected: ['JavaScript', 'React', 'TypeScript', 'Vue.js'] },
                { profession: 'backend', expected: ['Node.js', 'Python', 'Java', 'Go'] },
                { profession: undefined, expected: ['JavaScript', 'React', 'TypeScript', 'Vue.js'] },
            ];
            
            let allPassed = true;
            let testResults = '';
            
            tests.forEach(test => {
                const result = getDemoToolsForProfession(test.profession);
                const passed = JSON.stringify(result) === JSON.stringify(test.expected);
                allPassed = allPassed && passed;
                
                testResults += `
                    <p><strong>${test.profession || 'undefined'}:</strong> 
                    ${passed ? '‚úÖ' : '‚ùå'} ${JSON.stringify(result)}</p>
                `;
            });
            
            div.innerHTML = `
                <h3>üîß –¢–µ—Å—Ç Fallback —Ñ—É–Ω–∫—Ü–∏–∏</h3>
                ${testResults}
                <p><strong>–û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</strong> ${allPassed ? '‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã' : '‚ùå –ï—Å—Ç—å –æ—à–∏–±–∫–∏'}</p>
            `;
            
            div.className = allPassed ? 'test success' : 'test error';
            results.appendChild(div);
            
            return allPassed;
        }
        
        // –¢–µ—Å—Ç 3: –°–∏–º—É–ª—è—Ü–∏—è –æ—à–∏–±–∫–∏ API
        function testApiErrorHandling() {
            const div = document.createElement('div');
            div.className = 'test info';
            
            // –°–∏–º—É–ª–∏—Ä—É–µ–º –æ—à–∏–±–∫—É API
            const simulateApiError = () => {
                return new Promise((resolve, reject) => {
                    setTimeout(() => {
                        reject(new Error('Get user tools failed'));
                    }, 100);
                });
            };
            
            // –°–∏–º—É–ª–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–∫–∏
            const handleApiError = async () => {
                try {
                    await simulateApiError();
                } catch (err) {
                    console.log('üîß API Error simulated:', err.message);
                    
                    // Fallback –ª–æ–≥–∏–∫–∞
                    const demoTools = ['JavaScript', 'React', 'TypeScript', 'Node.js'];
                    console.log('üîß Using demo tools:', demoTools);
                    
                    return demoTools;
                }
            };
            
            handleApiError().then(tools => {
                div.innerHTML = `
                    <h3>üö® –¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ API</h3>
                    <p><strong>–û—à–∏–±–∫–∞ —Å–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–∞:</strong> ‚úÖ</p>
                    <p><strong>Fallback —Å—Ä–∞–±–æ—Ç–∞–ª:</strong> ‚úÖ</p>
                    <p><strong>–î–µ–º–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:</strong> ${JSON.stringify(tools)}</p>
                    <p><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç</p>
                `;
                div.className = 'test success';
            });
            
            results.appendChild(div);
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å–µ —Ç–µ—Å—Ç—ã
        console.log('üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ dev —Ä–µ–∂–∏–º–∞...');
        
        const devModeOk = testDevMode();
        const fallbackOk = testFallbackFunction();
        testApiErrorHandling();
        
        // –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        setTimeout(() => {
            const summaryDiv = document.createElement('div');
            summaryDiv.className = 'test info';
            summaryDiv.innerHTML = `
                <h3>üìä –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</h3>
                <p><strong>Dev —Ä–µ–∂–∏–º:</strong> ${devModeOk ? '‚úÖ' : '‚ùå'}</p>
                <p><strong>Fallback —Ñ—É–Ω–∫—Ü–∏—è:</strong> ${fallbackOk ? '‚úÖ' : '‚ùå'}</p>
                <p><strong>–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:</strong> ‚úÖ</p>
                <p><strong>–û–±—â–∏–π —Å—Ç–∞—Ç—É—Å:</strong> ${devModeOk && fallbackOk ? '‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã' : '‚ö†Ô∏è –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã'}</p>
            `;
            results.appendChild(summaryDiv);
        }, 500);
    </script>
</body>
</html>
