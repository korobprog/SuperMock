# –°–∏—Å—Ç–µ–º–∞ –æ–ø–ª–∞—Ç—ã YooMoney

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å.–î–µ–Ω—å–≥–∏ (YooMoney) —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ HTTP-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã](#–æ–±–∑–æ—Ä-—Å–∏—Å—Ç–µ–º—ã)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- [API Endpoints](#api-endpoints)
- [–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö](#–º–æ–¥–µ–ª–∏-–¥–∞–Ω–Ω—ã—Ö)
- [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [Troubleshooting](#troubleshooting)

## üéØ –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ –æ–ø–ª–∞—Ç—ã YooMoney –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å–æ–≤–µ—Ä—à–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å.–î–µ–Ω—å–≥–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ–π.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ HTTP-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç YooMoney
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–µ–π
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–ª–∞—Ç–µ–∂–µ–π

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

1. **–°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞** - —Å–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `label` –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
2. **–§–æ—Ä–º–∞ –æ–ø–ª–∞—Ç—ã** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É YooMoney
3. **HTTP-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ** - YooMoney –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞ –Ω–∞—à webhook
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏** - —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
5. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞** - –ø–ª–∞—Ç–µ–∂ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π
6. **–ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–µ–º–∏—É–º-—Ñ—É–Ω–∫—Ü–∏—è–º

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Frontend      ‚îÇ    ‚îÇ   Backend API   ‚îÇ    ‚îÇ   YooMoney      ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ Payment Form    ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Payment Routes  ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Payment Gateway ‚îÇ
‚îÇ Payment Status  ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÇ YooMoney Service‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÇ HTTP Webhook    ‚îÇ
‚îÇ Payment History ‚îÇ    ‚îÇ Payment Model   ‚îÇ    ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

1. **–°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞**
   ```
   Frontend ‚Üí POST /api/payments/create ‚Üí PaymentModel.create()
   ```

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
   ```
   YooMoney ‚Üí POST /api/payments/webhook/yoomoney ‚Üí YooMoneyService.verifyNotification()
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞**
   ```
   Frontend ‚Üí GET /api/payments/:id/status ‚Üí PaymentModel.findById()
   ```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ YooMoney

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [https://yoomoney.ru/myservices/online.xml](https://yoomoney.ru/myservices/online.xml)
2. –í–≤–µ–¥–∏—Ç–µ –ø–ª–∞—Ç—ë–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ HTTP-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
   - **URL —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**: `https://your-domain.com/api/payments/webhook/yoomoney`
   - **–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á**: —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –¥–ª—è `.env`
   - **–ü—Ä–æ—Ç–æ–∫–æ–ª**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ª–∏—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

### 2. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–æ–±–∞–≤—å—Ç–µ –≤ —Ñ–∞–π–ª `.env`:

```env
# YooMoney Configuration
YOOMONEY_RECEIVER=41001337976323
YOOMONEY_SECRET_KEY=your_secret_key_from_yoomoney
YOOMONEY_NOTIFICATION_URL=https://your-domain.com/api/payments/webhook/yoomoney
FRONTEND_URL=http://localhost:3000
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd backend
pnpm install
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
pnpm prisma:push
```

### 5. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
pnpm dev
```

## üîå API Endpoints

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞

```http
POST /api/payments/create
Authorization: Bearer <jwt_token>
Content-Type: application/json

{
  "amount": 100,
  "description": "–ü–æ–¥–¥–µ—Ä–∂–∫–∞ SuperMock"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "payment": {
    "id": "payment_123",
    "amount": 100,
    "currency": "RUB",
    "description": "–ü–æ–¥–¥–µ—Ä–∂–∫–∞ SuperMock",
    "status": "pending",
    "yoomoneyLabel": "user_123_payment_456_abc123",
    "createdAt": "2024-01-01T12:00:00Z"
  },
  "paymentForm": "<form>...</form>",
  "successUrl": "http://localhost:3000/payment/success?payment_id=payment_123",
  "failUrl": "http://localhost:3000/payment/fail?payment_id=payment_123"
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–ª–∞—Ç–µ–∂–µ

```http
GET /api/payments/:paymentId
Authorization: Bearer <jwt_token>
```

### –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π

```http
GET /api/payments/history/list?page=1&limit=10
Authorization: Bearer <jwt_token>
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```http
GET /api/payments/:paymentId/status
Authorization: Bearer <jwt_token>
```

### Webhook YooMoney

```http
POST /api/payments/webhook/yoomoney
Content-Type: application/x-www-form-urlencoded

notification_type=p2p-incoming&operation_id=123&amount=100&...
```

## üìä –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### Payment Model

```typescript
interface IPayment {
  id: string;
  userId: string;
  amount: number;
  currency: string;
  description: string;
  status: 'pending' | 'completed' | 'failed' | 'cancelled';
  yoomoneyLabel: string;
  yoomoneyOperationId?: string;
  yoomoneySha1Hash?: string;
  metadata?: any;
  createdAt: Date;
  updatedAt: Date;
}
```

### YooMoney Notification

```typescript
interface YooMoneyNotification {
  notification_type: string;
  operation_id: string;
  amount: number;
  currency: string;
  datetime: string;
  sender: string;
  codepro: boolean;
  label: string;
  sha1_hash: string;
  unaccepted: boolean;
  // HTTPS –ø–æ–ª—è
  firstname?: string;
  lastname?: string;
  email?: string;
  phone?: string;
  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
}
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ—Ç YooMoney —Å –ø–æ–º–æ—â—å—é SHA1 —Ö–µ—à–∞:

```typescript
const checkString = `${notification_type}&${operation_id}&${amount}&${currency}&${datetime}&${sender}&${codepro}&${secret_key}&${label}`;
const calculatedHash = crypto.createHash('sha1').update(checkString).digest('hex');
return calculatedHash === sha1_hash;
```

### –°—Ç–∞—Ç—É—Å—ã –ø–ª–∞—Ç–µ–∂–µ–π

- **pending** - –ø–ª–∞—Ç–µ–∂ —Å–æ–∑–¥–∞–Ω, –æ–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã
- **completed** - –ø–ª–∞—Ç–µ–∂ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω
- **failed** - –ø–ª–∞—Ç–µ–∂ –Ω–µ –ø—Ä–æ—à–µ–ª (unaccepted = true)
- **cancelled** - –ø–ª–∞—Ç–µ–∂ –æ—Ç–º–µ–Ω–µ–Ω

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```typescript
function checkPaymentStatus(notification: YooMoneyNotification): 'completed' | 'failed' | 'pending' {
  if (notification.unaccepted) return 'pending';
  if (notification.codepro) return 'pending';
  return 'completed';
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç–æ–≤—ã–π webhook

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `scripts/test-webhook.js`:

```javascript
const crypto = require('crypto');
const fetch = require('node-fetch');

const testNotification = {
  notification_type: 'p2p-incoming',
  operation_id: 'test-operation-123',
  amount: 100.00,
  currency: 'RUB',
  datetime: new Date().toISOString(),
  sender: 'test-sender',
  codepro: false,
  label: 'test-label-123',
  unaccepted: false,
  sha1_hash: 'test-hash'
};

// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ö–µ—à
const secretKey = process.env.YOOMONEY_SECRET_KEY || 'test-secret';
const checkString = `${testNotification.notification_type}&${testNotification.operation_id}&${testNotification.amount}&${testNotification.currency}&${testNotification.datetime}&${testNotification.sender}&${testNotification.codepro}&${secretKey}&${testNotification.label}`;
const calculatedHash = crypto.createHash('sha1').update(checkString).digest('hex');

testNotification.sha1_hash = calculatedHash;

// –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π webhook
async function testWebhook() {
  const response = await fetch('http://localhost:4000/api/payments/webhook/yoomoney', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(testNotification),
  });
  
  console.log('Status:', response.status);
  console.log('Response:', await response.text());
}

testWebhook();
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
node scripts/test-webhook.js
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:4000/payment.html`
2. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ñ–æ—Ä–º—ã YooMoney

## üîß Troubleshooting

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### 1. "Invalid signature" –æ—à–∏–±–∫–∞

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `YOOMONEY_SECRET_KEY` –≤ `.env`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º SHA1
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—è–¥–æ–∫ –ø–æ–ª–µ–π –≤ —Å—Ç—Ä–æ–∫–µ –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

#### 2. "Payment not found" –æ—à–∏–±–∫–∞

**–ü—Ä–∏—á–∏–Ω–∞:** Label –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–ª–∞—Ç–µ–∂ –±—ã–ª —Å–æ–∑–¥–∞–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º label
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ webhook –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π label
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π

#### 3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ webhook URL

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö YooMoney
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ HTTPS
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç 443 –æ—Ç–∫—Ä—ã—Ç

#### 4. –ü–ª–∞—Ç–µ–∂–∏ –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –û—à–∏–±–∫–∞ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ webhook

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è:

```typescript
// –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
console.log(`Payment ${payment.id} created for user ${userId}`);

// –ü–æ–ª—É—á–µ–Ω–∏–µ webhook
YooMoneyService.logNotification(notification);

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
console.error('YooMoney webhook error:', error);
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:

1. **–õ–æ–≥–∏ webhook** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
2. **–°—Ç–∞—Ç—É—Å—ã –ø–ª–∞—Ç–µ–∂–µ–π** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É—Å–ø–µ—à–Ω—ã—Ö/–Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
3. **–û—à–∏–±–∫–∏ –ø–æ–¥–ø–∏—Å–∏** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–¥–¥–µ–ª–∫–∏
4. **–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üìà –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–∞–ª—é—Ç—ã** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ USD, EUR
2. **–í–æ–∑–≤—Ä–∞—Ç—ã** - —Å–∏—Å—Ç–µ–º–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å—Ä–µ–¥—Å—Ç–≤
3. **–ü–æ–¥–ø–∏—Å–∫–∏** - —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏
4. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
5. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - email/SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–ª–∞—Ç–µ–∂–∞—Ö

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

- **Telegram Bot** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–ª–∞—Ç–µ–∂–∞—Ö
- **Email Service** - –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ–∫–æ–≤
- **Analytics** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
- **CRM** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è YooMoney](https://yoomoney.ru/docs/payment-buttons/using-api/forms)
- [HTTP-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è YooMoney](https://yoomoney.ru/docs/payment-buttons/using-api/notifications)
- [–ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏](https://misha.agency/yandex/http-uvedomleniya.html)

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** 1.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2024-01-01  
**–ê–≤—Ç–æ—Ä:** SuperMock Team
