# ÔøΩÔøΩ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≤–∏—Å–∞–Ω–∏–µ–º –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —è–∑—ã–∫–∞

## –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –¥–µ–º–æ –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∞–ª–æ –Ω–∞ —ç—Ç–∞–ø–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —è–∑—ã–∫–∞. –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –∏–∑-–∑–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ –≤–Ω–µ—à–Ω–µ–º—É API `https://ipapi.co/json/` –±–µ–∑ —Ç–∞–π–º–∞—É—Ç–∞.

## –ü—Ä–∏—á–∏–Ω–∞
–§—É–Ω–∫—Ü–∏—è `getLanguageByIP()` –≤ `frontend/src/lib/language-detection.ts` –≤—ã–ø–æ–ª–Ω—è–ª–∞ –∑–∞–ø—Ä–æ—Å –∫ –≤–Ω–µ—à–Ω–µ–º—É API –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏, —á—Ç–æ –º–æ–≥–ª–æ –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ –∑–∞–≤–∏—Å–∞–Ω–∏—é –ø—Ä–∏:
- –ú–µ–¥–ª–µ–Ω–Ω–æ–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏
- –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API —Å–µ—Ä–≤–∏—Å–∞
- –ü—Ä–æ–±–ª–µ–º–∞—Ö —Å DNS

## –†–µ—à–µ–Ω–∏–µ

### 1. –î–æ–±–∞–≤–ª–µ–Ω —Ç–∞–π–º–∞—É—Ç –¥–ª—è IP-–≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
```typescript
// –°–æ–∑–¥–∞–µ–º AbortController –¥–ª—è —Ç–∞–π–º–∞—É—Ç–∞
const controller = new AbortController();
const timeoutId = setTimeout(() => controller.abort(), 5000); // 5 —Å–µ–∫—É–Ω–¥ —Ç–∞–π–º–∞—É—Ç

const response = await fetch('https://ipapi.co/json/', {
  method: 'GET',
  headers: {
    Accept: 'application/json',
  },
  signal: controller.signal,
});
```

### 2. –ü—Ä–æ–ø—É—Å–∫ IP-–≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –≤ dev —Ä–µ–∂–∏–º–µ
```typescript
// –í dev —Ä–µ–∂–∏–º–µ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º IP-–≥–µ–æ–ª–æ–∫–∞—Ü–∏—é –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
if (import.meta.env.DEV) {
  console.log('üîß Dev mode detected, skipping IP geolocation for faster startup');
  console.log('üî§ Using fallback language: ru');
  return 'ru';
}
```

### 3. –î–æ–±–∞–≤–ª–µ–Ω —Ç–∞–π–º–∞—É—Ç –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```typescript
// –û–ø—Ä–µ–¥–µ–ª—è–µ–º —è–∑—ã–∫ —Å —Ç–∞–π–º–∞—É—Ç–æ–º
const languagePromise = detectUserLanguage();
const timeoutPromise = new Promise((_, reject) => 
  setTimeout(() => reject(new Error('Language detection timeout')), 10000)
);

const detectedLanguage = await Promise.race([languagePromise, timeoutPromise]) as SupportedLanguage;
```

## –§–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã

1. `frontend/src/lib/language-detection.ts`
   - –î–æ–±–∞–≤–ª–µ–Ω —Ç–∞–π–º–∞—É—Ç 5 —Å–µ–∫—É–Ω–¥ –¥–ª—è IP-–≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
   - –ü—Ä–æ–ø—É—Å–∫ IP-–≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –≤ dev —Ä–µ–∂–∏–º–µ
   - –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

2. `frontend/src/pages/Index.tsx`
   - –î–æ–±–∞–≤–ª–µ–Ω —Ç–∞–π–º–∞—É—Ç 10 —Å–µ–∫—É–Ω–¥ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω —Ç–∏–ø `SupportedLanguage`
   - –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
   ```bash
   NODE_ENV=development ./fix-language-detection.sh
   ```

2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ frontend:
   ```bash
   pnpm dev:frontend
   ```

3. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5173 –∏ –Ω–∞–∂–º–∏—Ç–µ "üß™ Enable Demo"

### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –±—ã—Å—Ç—Ä–æ (–≤ —Ç–µ—á–µ–Ω–∏–µ 1-2 —Å–µ–∫—É–Ω–¥)
- –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ —Ç–∞–π–º–∞—É—Ç–∞
- –¢–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å—Å—è –±–µ–∑ –∑–∞–≤–∏—Å–∞–Ω–∏—è
